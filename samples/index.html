<!DOCTYPE html>
<html>
    <head>
	    <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Fatina Sample</title>

        <script src="../build/ftina.js"></script>
        <style>
            .imgTest {
                position: relative;
            }

            hr {
                border-top: 1px dashed #8c8b8b;
	            border-bottom: 1px dashed #fff;
                margin-top: 25px !important;
                clear: both;
            }
        </style>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css">
    </head>
    <body>
        <div class="container">

            <h1>Basic Features</h1>
            <button class="btn btn-success" onclick="playAll()">PlayAll</button>

            <h3>Linear tween</h3>
            <img id="sample1" class="imgTest" src="Yuko_Blink_2.png"/>
            <script>
                function sample1() {
                    var elem = document.getElementById("sample1");

                    var obj = { x: 0, y: 0 };
                    ftina.Tween(obj, ['x'])
                        .From({x: 0})
                        .To({x: 500}, 2500)
                        .OnStart(() => console.log("tween1 start"))
                        .OnUpdate((dt, progress) => {
                            elem.style.left = obj.x + "px";
                        })
                        .OnComplete(() => console.log("tween1 complete"))
                        .Start();
                }
            </script>

            <hr/>

            <h3>Easing <small>(based on <a href="http://easings.net">easings.net</a>)</small></h3>
            <img id="sample2" class="imgTest" src="Yuko_Blink_2.png"/>
            <script>
                function sample2() {
                    var elem2 = document.getElementById("sample2");

                    var obj2 = { x: 0, y: 0 };
                    ftina.Tween(obj2, ['x'])
                        .To({x: 500}, 2500)
                        .SetEasing(Math.floor(Math.random()*30))
                        .OnStart(() => console.log("tween2 start"))
                        .OnUpdate((dt, progress) => {
                            elem2.style.left = obj2.x + "px";
                        })
                        .OnComplete(() => console.log("tween2 complete"))
                        .Start();
                }
            </script>

            <hr/>

            <h3>Sequence <small>(Sequential &amp; Parallel)</small></h3>
            <img id="sample3" class="imgTest" src="Yuko_Blink_2.png"/>
            <script>
                function sample3() {
                    var elem3 = document.getElementById("sample3");

                    var obj3 = { x: 0, y: 0, rotate:0 };
                    ftina.Sequence()
                        .Append(ftina.Tween(obj3, ['x']).To({x: 500}, 1250).SetEasing(6))
                        .AppendInterval(0.2)
                        .Append(ftina.Tween(obj3, ['x']).To({x: 0}, 1250).SetEasing(6))
                        .Join(ftina.Tween(obj3, ['rotate']).To({rotate: 360}, 1250).SetEasing(6))
                        .OnUpdate(() => {
                            elem3.style.left = obj3.x + "px";
                            elem3.style.transform = "rotate(" + obj3.rotate + "deg)"
                        })
                        .OnStart(() => console.log("tween3 start"))
                        .OnComplete(() => console.log("tween3 complete"))
                        .Start();
                }
            </script>

            <hr/>

            <h3>Pause / Resume</h3>
            <img id="sample4" class="imgTest" src="Yuko_Blink_2.png"/>
            <script>
                function sample4() {
                    var elem4 = document.getElementById("sample4");

                    var obj4 = { x: 0, y: 0, rotate:0 };
                    var sequence = ftina.Sequence()
                        .Append(ftina.Tween(obj4, ['x']).To({x: 500}, 1250).SetEasing(6))
                        .Append(ftina.Tween(obj4, ['x']).To({x: 0}, 1250).SetEasing(6))
                        .Join(ftina.Tween(obj4, ['rotate']).To({rotate: 360}, 1250).SetEasing(6))
                        .OnUpdate(() => {
                            elem4.style.left = obj4.x + "px";
                            elem4.style.transform = "rotate(" + obj4.rotate + "deg)"
                        })
                        .OnStart(() => console.log("tween4 start"))
                        .OnComplete(() => console.log("tween4 complete"));
                    sequence.Start();

                    setTimeout(() => sequence.Pause(), 1250);
                    setTimeout(() => sequence.Resume(), 2000);
                }
            </script>

            <hr/>

            <h3>Timescale <small>(on both sequence &amp; tween)</small></h3>
            <img id="sample5" class="imgTest" src="Yuko_Blink_2.png"/>
            <script>
                function sample5() {
                    var elem5 = document.getElementById("sample5");

                    var obj5 = { x: 0, y: 0, rotate:0 };
                    var sequence = ftina.Sequence()
                        .Append(ftina.Tween(obj5, ['x']).To({x: 500}, 1250).SetEasing(6))
                        .Append(ftina.Tween(obj5, ['x']).To({x: 0}, 1250).SetEasing(6))
                        .Join(ftina.Tween(obj5, ['rotate']).To({rotate: 360}, 1250).SetEasing(6).SetTimescale(2))
                        .OnUpdate(() => {
                            elem5.style.left = obj5.x + "px";
                            elem5.style.transform = "rotate(" + obj5.rotate + "deg)"
                        })
                        .SetTimescale(0.75)
                        .OnStart(() => console.log("tween5 start"))
                        .OnComplete(() => console.log("tween5 complete"));
                    sequence.Start();
                }
            </script>

            <hr/>

            <h3>Loop <small>(on both sequence &amp; tween)</small></h3>
            <img id="sample6" class="imgTest" src="Yuko_Blink_2.png"/>
            <script>
                function sample6() {
                    var elem6 = document.getElementById("sample6");
                    var obj6 = { x: 0, y: 0, rotate:0 };

                    // Create moving tween (loop twice)
                    ftina.Tween(obj6, ['x'])
                        .From({ x: 0 })
                        .To({x: 500}, 1250)
                        .SetLoop(2)
                        .SetEasing('inOutQuad')
                        .OnStart(() => console.log("tween6 start"))
                        .OnUpdate((dt, progress) => {
                            elem6.style.left = obj6.x + "px";
                        })
                        .OnComplete(() => console.log("tween6 move complete"))
                        .Start();

                    // Create a sequence of infinite rotation
                    ftina.Sequence()
                        .Join(
                            ftina.Tween(obj6, ['rotate'])
                                .From({rotate:0})
                                .To({rotate: 360}, 550)
                        )
                        .OnUpdate(() => {
                            elem6.style.transform = "rotate(" + obj6.rotate + "deg)"
                        })
                        .SetLoop(-1)
                        .OnStart(() => console.log("tween6 rotation start"))
                        .OnComplete(() => console.log("tween6 rotation complete"))
                        .Start();
                }
            </script>

             <hr/>

            <h3>Mix <small>(sequence + timescale + loop + parallel x 100 sprites in a canvas)</small></h3>
            <canvas id="canvas-mix"></canvas>
            <script>
                function sampleMix() {
                    var canvas = document.getElementById("canvas-mix");
                    canvas.width = 500;
                    canvas.height = 400;

                    var context = canvas.getContext("2d");

                    var img = new Image();
                    img.src = "Yuko_Blink_2.png";

                    var sprite = new Sprite(context, img, 200, 200, [ [0, 0] ]);
                    var spritePositions = [];

                    for (var i = 0; i < 100; i++) {
                        // Create one cat position
                        spritePositions.push({ x: 20, y: 80, dx: Math.random() * 8 - 4, dy: Math.random() * 8 - 4, timescale: Math.random() + 0.5 });

                        let currentSprite = spritePositions[spritePositions.length - 1];
                        // Create animation
                        var sequence = ftina.Sequence().SetLoop(-1);
                        sequence.AppendInterval(Math.random() * 1000);
                        sequence.Append(ftina.Tween(currentSprite, ['x', 'y']).To({ x: 280 + currentSprite.dx, y: 80 + currentSprite.dy}, 1400).SetEasing('inOutSine').SetTimescale(currentSprite.timescale));
                        sequence.Append(ftina.Tween(currentSprite, ['x', 'y']).To({ x: 50 + currentSprite.dx, y: 250 + currentSprite.dy}, 1400).SetEasing('inOutQuad').SetTimescale(currentSprite.timescale));
                        sequence.Append(ftina.Tween(currentSprite, ['x', 'y']).To({ x: 150 + currentSprite.dx, y: 0 + currentSprite.dy}, 1400).SetEasing('inOutSine').SetTimescale(currentSprite.timescale));
                        sequence.Append(ftina.Tween(currentSprite, ['x', 'y']).To({ x: 250 + currentSprite.dx, y: 250 + currentSprite.dy}, 1400).SetEasing('inOutQuad').SetTimescale(currentSprite.timescale));
                        sequence.Append(ftina.Tween(currentSprite, ['x', 'y']).To({ x: 20 + currentSprite.dx, y: 80 + currentSprite.dy}, 1400).SetEasing('inOutQuad').SetTimescale(currentSprite.timescale));
                        sequence.Start();
                    }

                    // Canvas Rendering Loop
                    ftina.Tween({}, [])
                        .SetLoop(-1)
                        .OnUpdate((dt) => {
                            context.clearRect(0, 0, canvas.width, canvas.height);
                            for (var i = 0; i < spritePositions.length; i++) {
                                sprite.draw(0, spritePositions[i].x, spritePositions[i].y);
                            }
                        })
                        .Start();
                }
            </script>
        </div>
        <script>
            function playAll() {
                sample1();
                sample2();
                sample3();
                sample4();
                sample5();
                sample6();
            }

            (function() {
                 setTimeout(() => playAll(), 500);
                 setTimeout(() => sampleMix(), 1500);
            })();

            // small wrapper to make the sample code smaller
            function Sprite(context, img, width, height, positions){
                this.context = context;
                this.img = img;
                this.width = width;
                this.height = height;
                this.positions = positions;
            }

            Sprite.prototype = {
                draw: function(position, x, y){
                    var pos = this.positions[position];
                    this.context.drawImage(
                        this.img,
                        pos[0],
                        pos[1],
                        this.width,
                        this.height,
                        x, y,
                        this.width,
                        this.height
                    );
                }
            };
        </script>
    </body>
</html>